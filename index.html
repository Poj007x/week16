<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° - ‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏™‡∏±‡∏ï‡∏´‡∏µ‡∏ö</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Sarabun', sans-serif; }
        .bg-gradient-dark {
            background: linear-gradient(135deg, #1e293b 0%, #334155 50%, #475569 100%);
        }
        .card-shadow {
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3b82f6;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .match-card {
            transition: all 0.3s ease;
        }
        .match-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }
        .sport-tab {
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .sport-tab.active {
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
        }
    </style>
</head>
<body class="bg-gradient-dark min-h-screen">
    <!-- Header -->
    <header class="bg-white shadow-lg">
        <div class="max-w-7xl mx-auto px-4 py-6">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-3xl font-bold text-gray-900">‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</h1>
                    <p class="text-lg text-gray-600 mt-1">‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏™‡∏±‡∏ï‡∏´‡∏µ‡∏ö | ‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ 2568</p>
                </div>
                <div class="text-right">
                    <div class="text-sm text-gray-500">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</div>
                    <div class="text-lg font-semibold text-gray-900" id="currentDate"></div>
                </div>
            </div>
        </div>
    </header>

    <div class="max-w-7xl mx-auto px-4 py-8">
        <!-- Navigation Tabs -->
        <div class="bg-white rounded-lg shadow-lg mb-8">
            <div class="flex border-b overflow-x-auto">
                <button onclick="showTab('dashboard')" id="dashboardTab" class="px-6 py-4 font-semibold text-blue-600 border-b-2 border-blue-600 whitespace-nowrap">
                    üìä ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
                </button>
                <button onclick="showTab('addActivity')" id="addActivityTab" class="px-6 py-4 font-semibold text-gray-600 hover:text-blue-600 whitespace-nowrap">
                    ‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÉ‡∏´‡∏°‡πà
                </button>
                <button onclick="showTab('search')" id="searchTab" class="px-6 py-4 font-semibold text-gray-600 hover:text-blue-600 whitespace-nowrap">
                    üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°
                </button>
                <button onclick="showTab('sports')" id="sportsTab" class="px-6 py-4 font-semibold text-gray-600 hover:text-blue-600 whitespace-nowrap">
                    üèÜ ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡∏Å‡∏µ‡∏¨‡∏≤
                </button>
            </div>
        </div>

        <!-- Dashboard Tab -->
        <div id="dashboardContent" class="tab-content">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                <div class="bg-white rounded-lg p-6 card-shadow">
                    <div class="flex items-center">
                        <div class="p-3 bg-blue-100 rounded-full">
                            <span class="text-2xl">üìÖ</span>
                        </div>
                        <div class="ml-4">
                            <h3 class="text-lg font-semibold text-gray-900">‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h3>
                            <p class="text-3xl font-bold text-blue-600" id="totalActivities">0</p>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-lg p-6 card-shadow">
                    <div class="flex items-center">
                        <div class="p-3 bg-green-100 rounded-full">
                            <span class="text-2xl">üì∏</span>
                        </div>
                        <div class="ml-4">
                            <h3 class="text-lg font-semibold text-gray-900">‡∏†‡∏≤‡∏û‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</h3>
                            <p class="text-3xl font-bold text-green-600" id="totalImages">0</p>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-lg p-6 card-shadow">
                    <div class="flex items-center">
                        <div class="p-3 bg-purple-100 rounded-full">
                            <span class="text-2xl">üë•</span>
                        </div>
                        <div class="ml-4">
                            <h3 class="text-lg font-semibold text-gray-900">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</h3>
                            <p class="text-3xl font-bold text-purple-600" id="thisMonthActivities">0</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-lg p-6 card-shadow">
                <h2 class="text-xl font-bold text-gray-900 mb-4">‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h2>
                <div id="recentActivities" class="space-y-4">
                    <div class="text-center text-gray-500 py-8">
                        <span class="text-4xl">üìù</span>
                        <p class="mt-2">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</p>
                        <button onclick="showTab('addActivity')" class="mt-4 bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                            ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÅ‡∏£‡∏Å
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Add Activity Tab -->
        <div id="addActivityContent" class="tab-content hidden">
            <div class="bg-white rounded-lg p-8 card-shadow">
                <h2 class="text-2xl font-bold text-gray-900 mb-6">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÉ‡∏´‡∏°‡πà</h2>
                
                <form id="activityForm" class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° *</label>
                            <input type="text" id="activityName" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° *</label>
                            <input type="date" id="activityDate" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° *</label>
                            <input type="text" id="responsible" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-semibold text-gray-700 mb-2">‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ *</label>
                            <input type="text" id="targetGroup" required class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå‡∏Ç‡∏≠‡∏á‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° *</label>
                        <textarea id="objective" required rows="3" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                    </div>

                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° *</label>
                        <textarea id="details" required rows="4" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                    </div>

                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏∂‡πâ‡∏ô *</label>
                        <textarea id="results" required rows="3" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                    </div>

                    <!-- File Upload Section -->
                    <div class="border-2 border-dashed border-gray-300 rounded-lg p-6">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4">‡πÅ‡∏ô‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô</h3>
                        
                        <div class="mb-4">
                            <label class="block text-sm font-semibold text-gray-700 mb-2">‡∏†‡∏≤‡∏û‡∏ñ‡πà‡∏≤‡∏¢‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏° (1-3 ‡∏£‡∏π‡∏õ)</label>
                            <input type="file" id="images" multiple accept="image/*" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <p class="text-sm text-gray-500 mt-1">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå: JPG, PNG, GIF (‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 5MB ‡∏ï‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå)</p>
                        </div>

                        <div class="mb-4">
                            <label class="block text-sm font-semibold text-gray-700 mb-2">‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° (PDF)</label>
                            <input type="file" id="documents" multiple accept=".pdf" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <p class="text-sm text-gray-500 mt-1">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå: PDF (‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 10MB ‡∏ï‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå)</p>
                        </div>

                        <div id="filePreview" class="mt-4 hidden">
                            <h4 class="font-semibold text-gray-700 mb-2">‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å:</h4>
                            <div id="previewContent" class="space-y-2"></div>
                        </div>
                    </div>

                    <div class="flex justify-end space-x-4">
                        <button type="button" onclick="resetForm()" class="px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors">
                            ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                        </button>
                        <button type="submit" id="submitBtn" class="px-8 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold">
                            ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Search Tab -->
        <div id="searchContent" class="tab-content hidden">
            <div class="bg-white rounded-lg p-6 card-shadow mb-6">
                <h2 class="text-xl font-bold text-gray-900 mb-4">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</label>
                        <input type="text" id="searchName" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°..." class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö</label>
                        <input type="text" id="searchResponsible" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö..." class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î</label>
                        <select id="searchMonth" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="">‡∏ó‡∏∏‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</option>
                            <option value="01">‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°</option>
                            <option value="02">‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå</option>
                            <option value="03">‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°</option>
                            <option value="04">‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô</option>
                            <option value="05">‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°</option>
                            <option value="06">‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô</option>
                            <option value="07">‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°</option>
                            <option value="08">‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°</option>
                            <option value="09">‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô</option>
                            <option value="10">‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°</option>
                            <option value="11">‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô</option>
                            <option value="12">‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°</option>
                        </select>
                    </div>
                </div>
                <div class="mt-4">
                    <button onclick="searchActivities()" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                        üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
                    </button>
                    <button onclick="clearSearch()" class="ml-2 bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600 transition-colors">
                        ‡∏•‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
                    </button>
                </div>
            </div>

            <div class="bg-white rounded-lg p-6 card-shadow">
                <h3 class="text-lg font-bold text-gray-900 mb-4">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</h3>
                <div id="searchResults">
                    <div class="text-center text-gray-500 py-8">
                        <span class="text-4xl">üîç</span>
                        <p class="mt-2">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sports Competition Tab -->
        <div id="sportsContent" class="tab-content hidden">
            <!-- Sports Header -->
            <div class="bg-white rounded-lg p-6 card-shadow mb-6">
                <div class="text-center">
                    <h2 class="text-3xl font-bold text-gray-900 mb-2">üèÜ ‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡∏Å‡∏µ‡∏¨‡∏≤‡∏™‡∏µ‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡∏õ‡∏µ 2568</h2>
                    <p class="text-lg text-gray-600">‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏•‡∏±‡∏¢‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏™‡∏±‡∏ï‡∏´‡∏µ‡∏ö</p>
                    <p class="text-md text-blue-600 font-semibold mt-2">üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 22 - 26 ‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô 2568</p>
                </div>
            </div>

            <!-- Sports Navigation -->
            <div class="bg-white rounded-lg p-4 card-shadow mb-6">
                <div class="grid grid-cols-3 md:grid-cols-5 lg:grid-cols-9 gap-2" id="sportsNav">
                    <button onclick="showSport('futsal-male')" class="sport-tab active px-3 py-2 rounded-lg text-sm font-semibold">‚öΩ ‡∏ü‡∏∏‡∏ï‡∏ã‡∏≠‡∏•‡∏ä‡∏≤‡∏¢</button>
                    <button onclick="showSport('futsal-female')" class="sport-tab px-3 py-2 rounded-lg text-sm font-semibold">‚öΩ ‡∏ü‡∏∏‡∏ï‡∏ã‡∏≠‡∏•‡∏´‡∏ç‡∏¥‡∏á</button>
                    <button onclick="showSport('basketball')" class="sport-tab px-3 py-2 rounded-lg text-sm font-semibold">üèÄ ‡∏ö‡∏≤‡∏™‡πÄ‡∏Å‡∏ï‡∏ö‡∏≠‡∏•</button>
                    <button onclick="showSport('volleyball')" class="sport-tab px-3 py-2 rounded-lg text-sm font-semibold">üèê ‡∏ß‡∏≠‡∏•‡πÄ‡∏•‡∏¢‡πå‡∏ö‡∏≠‡∏•</button>
                    <button onclick="showSport('sepaktakraw')" class="sport-tab px-3 py-2 rounded-lg text-sm font-semibold">ü•é ‡πÄ‡∏ã‡∏õ‡∏±‡∏Å‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≠</button>
                    <button onclick="showSport('petanque')" class="sport-tab px-3 py-2 rounded-lg text-sm font-semibold">üéØ ‡πÄ‡∏õ‡∏ï‡∏≠‡∏á</button>
                    <button onclick="showSport('esport')" class="sport-tab px-3 py-2 rounded-lg text-sm font-semibold">üéÆ E-sport</button>
                    <button onclick="showSport('checkers')" class="sport-tab px-3 py-2 rounded-lg text-sm font-semibold">‚ö´ ‡∏´‡∏°‡∏≤‡∏Å‡∏Æ‡∏≠‡∏™</button>
                    <button onclick="showSport('chess')" class="sport-tab px-3 py-2 rounded-lg text-sm font-semibold">‚ôüÔ∏è ‡∏´‡∏°‡∏≤‡∏Å‡∏£‡∏∏‡∏Å</button>
                </div>
            </div>

            <!-- Sports Content -->
            <div id="sportsSchedule" class="bg-white rounded-lg p-6 card-shadow">
                <!-- Content will be loaded dynamically -->
            </div>
        </div>
    </div>

    <!-- Loading Modal -->
    <div id="loadingModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg p-8 max-w-sm w-full mx-4">
            <div class="text-center">
                <div class="loading-spinner mx-auto mb-4"></div>
                <h3 class="text-lg font-semibold text-gray-900 mb-2">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h3>
                <p class="text-gray-600" id="loadingText">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà...</p>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div id="successModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg p-8 max-w-sm w-full mx-4">
            <div class="text-center">
                <div class="text-6xl text-green-500 mb-4">‚úÖ</div>
                <h3 class="text-lg font-semibold text-gray-900 mb-2">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</h3>
                <p class="text-gray-600 mb-4">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß</p>
                <button onclick="closeSuccessModal()" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                    ‡∏ï‡∏Å‡∏•‡∏á
                </button>
            </div>
        </div>
    </div>

    <script>
        // Global variables - ‡πÉ‡∏™‡πà URL ‡∏Ç‡∏≠‡∏á Apps Script ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å Deploy
        const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzXCOn4BHD1RcDBMFyIYNubV1H66aBh3bhZyb7oSHKOZpdviChCDlze7LpaSAT0uVZU/exec';
        let activitiesData = [];

        // Sports data
        const departments = [
            '‡∏ä‡πà‡∏≤‡∏á‡∏¢‡∏ô‡∏ï‡πå', '‡∏ä‡πà‡∏≤‡∏á‡∏Å‡∏•‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô', '‡∏ä‡πà‡∏≤‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏•‡∏´‡∏∞‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏•‡∏≤‡∏¢ (NDT)', '‡∏ä‡πà‡∏≤‡∏á‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á',
            '‡∏ä‡πà‡∏≤‡∏á‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå', '‡∏ä‡πà‡∏≤‡∏á‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á', '‡∏ä‡πà‡∏≤‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÅ‡∏ö‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Å‡∏•', '‡πÄ‡∏°‡∏Ñ‡∏Ñ‡∏≤‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå',
            '‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ß‡∏±‡∏î‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°', '‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô', '‡∏ä‡πà‡∏≤‡∏á‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏¢‡∏≤‡∏ô', '‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÅ‡∏•‡∏∞‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏ô‡∏™‡πà‡∏á‡∏ó‡∏≤‡∏á‡∏£‡∏≤‡∏á',
            '‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ç‡∏ä‡∏µ', '‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à', '‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏Å‡∏≤‡∏£‡∏ö‡∏¥‡∏ô', '‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏•‡∏à‡∏¥‡∏™‡∏ï‡∏¥‡∏Å‡∏™‡πå‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏Ñ‡πâ‡∏≤‡∏õ‡∏•‡∏µ‡∏Å',
            '‡∏Å‡∏≤‡∏£‡πÇ‡∏£‡∏á‡πÅ‡∏£‡∏°', '‡∏Å‡∏≤‡∏£‡∏ó‡πà‡∏≠‡∏á‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß', '‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®‡πÅ‡∏•‡∏∞‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå', '‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô'
        ];

        const sportsData = {
            'futsal-male': {
                name: '‡∏ü‡∏∏‡∏ï‡∏ã‡∏≠‡∏•‡∏ä‡∏≤‡∏¢',
                icon: '‚öΩ',
                teams: ['‡∏ä‡πà‡∏≤‡∏á‡∏¢‡∏ô‡∏ï‡πå', '‡∏ä‡πà‡∏≤‡∏á‡∏Å‡∏•‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô', '‡∏ä‡πà‡∏≤‡∏á‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á', '‡∏ä‡πà‡∏≤‡∏á‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå', '‡∏ä‡πà‡∏≤‡∏á‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á', '‡πÄ‡∏°‡∏Ñ‡∏Ñ‡∏≤‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå', '‡∏ä‡πà‡∏≤‡∏á‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏¢‡∏≤‡∏ô', '‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô']
            },
            'futsal-female': {
                name: '‡∏ü‡∏∏‡∏ï‡∏ã‡∏≠‡∏•‡∏´‡∏ç‡∏¥‡∏á',
                icon: '‚öΩ',
                teams: ['‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ç‡∏ä‡∏µ', '‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à', '‡∏Å‡∏≤‡∏£‡πÇ‡∏£‡∏á‡πÅ‡∏£‡∏°', '‡∏Å‡∏≤‡∏£‡∏ó‡πà‡∏≠‡∏á‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß', '‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏Å‡∏≤‡∏£‡∏ö‡∏¥‡∏ô', '‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏•‡∏à‡∏¥‡∏™‡∏ï‡∏¥‡∏Å‡∏™‡πå‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏Ñ‡πâ‡∏≤‡∏õ‡∏•‡∏µ‡∏Å']
            },
            'basketball': {
                name: '‡∏ö‡∏≤‡∏™‡πÄ‡∏Å‡∏ï‡∏ö‡∏≠‡∏•',
                icon: 'üèÄ',
                teams: ['‡∏ä‡πà‡∏≤‡∏á‡∏¢‡∏ô‡∏ï‡πå', '‡∏ä‡πà‡∏≤‡∏á‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå', '‡πÄ‡∏°‡∏Ñ‡∏Ñ‡∏≤‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå', '‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®‡πÅ‡∏•‡∏∞‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå', '‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ç‡∏ä‡∏µ', '‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à', '‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô', '‡∏ä‡πà‡∏≤‡∏á‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏¢‡∏≤‡∏ô']
            },
            'volleyball': {
                name: '‡∏ß‡∏≠‡∏•‡πÄ‡∏•‡∏¢‡πå‡∏ö‡∏≠‡∏•',
                icon: 'üèê',
                teams: ['‡∏ä‡πà‡∏≤‡∏á‡∏Å‡∏•‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô', '‡∏ä‡πà‡∏≤‡∏á‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á', '‡∏ä‡πà‡∏≤‡∏á‡∏Å‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á', '‡∏ä‡πà‡∏≤‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÅ‡∏ö‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Å‡∏•', '‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ß‡∏±‡∏î‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°', '‡∏Å‡∏≤‡∏£‡πÇ‡∏£‡∏á‡πÅ‡∏£‡∏°', '‡∏Å‡∏≤‡∏£‡∏ó‡πà‡∏≠‡∏á‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß', '‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏Å‡∏≤‡∏£‡∏ö‡∏¥‡∏ô']
            },
            'sepaktakraw': {
                name: '‡πÄ‡∏ã‡∏õ‡∏±‡∏Å‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≠',
                icon: 'ü•é',
                teams: ['‡∏ä‡πà‡∏≤‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏•‡∏´‡∏∞‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏•‡∏≤‡∏¢ (NDT)', '‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô', '‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÅ‡∏•‡∏∞‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏Ç‡∏ô‡∏™‡πà‡∏á‡∏ó‡∏≤‡∏á‡∏£‡∏≤‡∏á', '‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏•‡∏à‡∏¥‡∏™‡∏ï‡∏¥‡∏Å‡∏™‡πå‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏Ñ‡πâ‡∏≤‡∏õ‡∏•‡∏µ‡∏Å', '‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô', '‡∏ä‡πà‡∏≤‡∏á‡∏¢‡∏ô‡∏ï‡πå']
            },
            'petanque': {
                name: '‡πÄ‡∏õ‡∏ï‡∏≠‡∏á',
                icon: 'üéØ',
                teams: ['‡∏ä‡πà‡∏≤‡∏á‡∏¢‡∏ô‡∏ï‡πå', '‡∏ä‡πà‡∏≤‡∏á‡∏Å‡∏•‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô', '‡∏ä‡πà‡∏≤‡∏á‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‡∏Å‡∏≥‡∏•‡∏±‡∏á', '‡∏ä‡πà‡∏≤‡∏á‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå', '‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ç‡∏ä‡∏µ', '‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à', '‡∏Å‡∏≤‡∏£‡πÇ‡∏£‡∏á‡πÅ‡∏£‡∏°', '‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®‡πÅ‡∏•‡∏∞‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå']
            },
            'esport': {
                name: 'E-sport',
                icon: 'üéÆ',
                teams: ['‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®‡πÅ‡∏•‡∏∞‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå', '‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à', '‡∏ä‡πà‡∏≤‡∏á‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå', '‡πÄ‡∏°‡∏Ñ‡∏Ñ‡∏≤‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå', '‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ß‡∏±‡∏î‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°', '‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô']
            },
            'checkers': {
                name: '‡∏´‡∏°‡∏≤‡∏Å‡∏Æ‡∏≠‡∏™',
                icon: '‚ö´',
                teams: ['‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ç‡∏ä‡∏µ', '‡∏Å‡∏≤‡∏£‡πÇ‡∏£‡∏á‡πÅ‡∏£‡∏°', '‡∏Å‡∏≤‡∏£‡∏ó‡πà‡∏≠‡∏á‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏ß', '‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏Å‡∏≤‡∏£‡∏ö‡∏¥‡∏ô', '‡∏ä‡πà‡∏≤‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÅ‡∏ö‡∏ö‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Å‡∏•', '‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô']
            },
            'chess': {
                name: '‡∏´‡∏°‡∏≤‡∏Å‡∏£‡∏∏‡∏Å',
                icon: '‚ôüÔ∏è',
                teams: ['‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®‡πÅ‡∏•‡∏∞‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå', '‡∏Ñ‡∏≠‡∏°‡∏û‡∏¥‡∏ß‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à', '‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ç‡∏ä‡∏µ', '‡∏ä‡πà‡∏≤‡∏á‡∏≠‡∏¥‡πÄ‡∏•‡πá‡∏Å‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå', '‡πÄ‡∏°‡∏Ñ‡∏Ñ‡∏≤‡∏ó‡∏£‡∏≠‡∏ô‡∏¥‡∏Å‡∏™‡πå', '‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏ß‡∏±‡∏î‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°']
            }
        };

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            updateCurrentDate();
            loadActivities();
            setupFilePreview();
            showSport('futsal-male'); // Show first sport by default
        });

        // Update current date
        function updateCurrentDate() {
            const now = new Date();
            const options = { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                weekday: 'long'
            };
            document.getElementById('currentDate').textContent = now.toLocaleDateString('th-TH', options);
        }

        // Tab management
        function showTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.add('hidden');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('[id$="Tab"]').forEach(tab => {
                tab.classList.remove('text-blue-600', 'border-b-2', 'border-blue-600');
                tab.classList.add('text-gray-600');
            });
            
            // Show selected tab content
            document.getElementById(tabName + 'Content').classList.remove('hidden');
            
            // Add active class to selected tab
            const activeTab = document.getElementById(tabName + 'Tab');
            activeTab.classList.remove('text-gray-600');
            activeTab.classList.add('text-blue-600', 'border-b-2', 'border-blue-600');
        }

        // Sports management
        function showSport(sportKey) {
            // Update sport navigation
            document.querySelectorAll('.sport-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Generate schedule for selected sport
            generateSportSchedule(sportKey);
        }

        function generateSportSchedule(sportKey) {
            const sport = sportsData[sportKey];
            const container = document.getElementById('sportsSchedule');
            
            // Generate matches
            const matches = generateMatches(sport.teams);
            
            // Group matches by day
            const matchesByDay = groupMatchesByDay(matches);
            
            let html = `
                <div class="text-center mb-6">
                    <h3 class="text-2xl font-bold text-gray-900">${sport.icon} ${sport.name}</h3>
                    <p class="text-gray-600 mt-2">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡πà‡∏ß‡∏°: ${sport.teams.length} ‡∏ó‡∏µ‡∏° | ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÅ‡∏°‡∏ï‡∏ä‡πå: ${matches.length} ‡πÅ‡∏°‡∏ï‡∏ä‡πå</p>
                </div>
            `;
            
            // Display matches by day
            Object.keys(matchesByDay).forEach(day => {
                const dayMatches = matchesByDay[day];
                html += `
                    <div class="mb-8">
                        <h4 class="text-xl font-bold text-blue-600 mb-4 border-b-2 border-blue-200 pb-2">
                            üìÖ ${day}
                        </h4>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                `;
                
                dayMatches.forEach(match => {
                    html += `
                        <div class="match-card bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-4">
                            <div class="text-center">
                                <div class="text-sm text-blue-600 font-semibold mb-2">‚è∞ ${match.time}</div>
                                <div class="flex items-center justify-between">
                                    <div class="text-sm font-semibold text-gray-800 flex-1 text-center">
                                        ${match.team1}
                                    </div>
                                    <div class="mx-3 text-lg font-bold text-blue-600">VS</div>
                                    <div class="text-sm font-semibold text-gray-800 flex-1 text-center">
                                        ${match.team2}
                                    </div>
                                </div>
                                <div class="mt-2 text-xs text-gray-500">‡πÅ‡∏°‡∏ï‡∏ä‡πå‡∏ó‡∏µ‡πà ${match.matchNumber}</div>
                            </div>
                        </div>
                    `;
                });
                
                html += `
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        function generateMatches(teams) {
            const matches = [];
            let matchNumber = 1;
            
            // Generate round-robin matches
            for (let i = 0; i < teams.length; i++) {
                for (let j = i + 1; j < teams.length; j++) {
                    matches.push({
                        matchNumber: matchNumber++,
                        team1: teams[i],
                        team2: teams[j]
                    });
                }
            }
            
            return matches;
        }

        function groupMatchesByDay(matches) {
            const days = [
                '‡∏ß‡∏±‡∏ô‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå‡∏ó‡∏µ‡πà 22 ‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô 2568',
                '‡∏ß‡∏±‡∏ô‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£‡∏ó‡∏µ‡πà 23 ‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô 2568', 
                '‡∏ß‡∏±‡∏ô‡∏û‡∏∏‡∏ò‡∏ó‡∏µ‡πà 24 ‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô 2568',
                '‡∏ß‡∏±‡∏ô‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ‡∏ó‡∏µ‡πà 25 ‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô 2568',
                '‡∏ß‡∏±‡∏ô‡∏®‡∏∏‡∏Å‡∏£‡πå‡∏ó‡∏µ‡πà 26 ‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô 2568'
            ];
            
            const times = [
                '08:00', '08:30', '09:00', '09:30', '10:00', '10:30', '11:00', '11:30',
                '13:00', '13:30', '14:00', '14:30', '15:00', '15:30', '16:00', '16:30'
            ];
            
            const matchesByDay = {};
            const totalMatches = matches.length;
            const matchesPerDay = Math.ceil(totalMatches / 5); // ‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏ó‡πà‡∏≤‡πÜ ‡∏Å‡∏±‡∏ô 5 ‡∏ß‡∏±‡∏ô
            
            // Initialize all days
            days.forEach(day => {
                matchesByDay[day] = [];
            });
            
            let currentDayIndex = 0;
            let matchesInCurrentDay = 0;
            let timeIndex = 0;
            
            matches.forEach((match, index) => {
                const currentDay = days[currentDayIndex];
                
                match.time = times[timeIndex % times.length];
                matchesByDay[currentDay].push(match);
                
                matchesInCurrentDay++;
                timeIndex++;
                
                // ‡∏ñ‡πâ‡∏≤‡πÅ‡∏°‡∏ï‡∏ä‡πå‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏Ñ‡∏£‡∏ö‡πÅ‡∏•‡πâ‡∏ß ‡∏´‡∏£‡∏∑‡∏≠ ‡πÄ‡∏ß‡∏•‡∏≤‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏´‡πâ‡πÑ‡∏õ‡∏ß‡∏±‡∏ô‡∏ñ‡∏±‡∏î‡πÑ‡∏õ
                if (matchesInCurrentDay >= matchesPerDay || timeIndex >= times.length) {
                    currentDayIndex++;
                    matchesInCurrentDay = 0;
                    timeIndex = 0;
                    
                    // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏Å‡∏¥‡∏ô 5 ‡∏ß‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß ‡πÉ‡∏´‡πâ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ß‡∏±‡∏ô‡πÅ‡∏£‡∏Å (‡∏Å‡∏£‡∏ì‡∏µ‡πÅ‡∏°‡∏ï‡∏ä‡πå‡πÄ‡∏¢‡∏≠‡∏∞‡∏°‡∏≤‡∏Å)
                    if (currentDayIndex >= days.length) {
                        currentDayIndex = 0;
                    }
                }
            });
            
            return matchesByDay;
        }

        // File preview setup
        function setupFilePreview() {
            const imageInput = document.getElementById('images');
            const documentInput = document.getElementById('documents');
            
            imageInput.addEventListener('change', updateFilePreview);
            documentInput.addEventListener('change', updateFilePreview);
        }

        function updateFilePreview() {
            const imageFiles = document.getElementById('images').files;
            const documentFiles = document.getElementById('documents').files;
            const preview = document.getElementById('filePreview');
            const content = document.getElementById('previewContent');
            
            content.innerHTML = '';
            
            if (imageFiles.length > 0 || documentFiles.length > 0) {
                preview.classList.remove('hidden');
                
                // Preview images
                Array.from(imageFiles).forEach((file, index) => {
                    if (index < 3) { // Limit to 3 images
                        const div = document.createElement('div');
                        div.className = 'flex items-center space-x-2 text-sm text-gray-600';
                        div.innerHTML = `<span>üì∏</span><span>${file.name} (${(file.size/1024/1024).toFixed(2)} MB)</span>`;
                        content.appendChild(div);
                    }
                });
                
                // Preview documents
                Array.from(documentFiles).forEach(file => {
                    const div = document.createElement('div');
                    div.className = 'flex items-center space-x-2 text-sm text-gray-600';
                    div.innerHTML = `<span>üìÑ</span><span>${file.name} (${(file.size/1024/1024).toFixed(2)} MB)</span>`;
                    content.appendChild(div);
                });
            } else {
                preview.classList.add('hidden');
            }
        }

        // Convert file to base64
        function fileToBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = () => resolve(reader.result.split(',')[1]);
                reader.onerror = error => reject(error);
            });
        }

        // Form submission
        document.getElementById('activityForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const submitBtn = document.getElementById('submitBtn');
            const loadingModal = document.getElementById('loadingModal');
            const loadingText = document.getElementById('loadingText');
            
            // Disable submit button to prevent double submission
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<div class="loading-spinner inline-block mr-2"></div>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...';
            
            try {
                // Validate required fields
                const requiredFields = ['activityName', 'activityDate', 'responsible', 'targetGroup', 'objective', 'details', 'results'];
                for (let field of requiredFields) {
                    const value = document.getElementById(field).value.trim();
                    if (!value) {
                        throw new Error(`‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å${document.querySelector(`label[for="${field}"], label`).textContent.replace(' *', '')}`);
                    }
                }
                
                // Show loading modal
                loadingModal.classList.remove('hidden');
                loadingText.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...';
                
                // Get form data
                const formData = {
                    activityName: document.getElementById('activityName').value.trim(),
                    activityDate: document.getElementById('activityDate').value,
                    responsible: document.getElementById('responsible').value.trim(),
                    targetGroup: document.getElementById('targetGroup').value.trim(),
                    objective: document.getElementById('objective').value.trim(),
                    details: document.getElementById('details').value.trim(),
                    results: document.getElementById('results').value.trim(),
                    timestamp: new Date().toISOString()
                };
                
                // Process files
                const imageFiles = document.getElementById('images').files;
                const documentFiles = document.getElementById('documents').files;
                
                loadingText.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡πÑ‡∏ü‡∏•‡πå...';
                
                // Convert images to base64
                const images = [];
                for (let i = 0; i < Math.min(imageFiles.length, 3); i++) {
                    const file = imageFiles[i];
                    if (file.size > 5 * 1024 * 1024) { // 5MB limit
                        throw new Error(`‡πÑ‡∏ü‡∏•‡πå ${file.name} ‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏Å‡∏¥‡∏ô 5MB`);
                    }
                    const base64 = await fileToBase64(file);
                    images.push({
                        name: file.name,
                        type: file.type,
                        data: base64
                    });
                }
                
                // Convert documents to base64
                const documents = [];
                for (let file of documentFiles) {
                    if (file.size > 10 * 1024 * 1024) { // 10MB limit
                        throw new Error(`‡πÑ‡∏ü‡∏•‡πå ${file.name} ‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏Å‡∏¥‡∏ô 10MB`);
                    }
                    const base64 = await fileToBase64(file);
                    documents.push({
                        name: file.name,
                        type: file.type,
                        data: base64
                    });
                }
                
                // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÑ‡∏î‡πâ‡πÉ‡∏™‡πà URL ‡∏Ç‡∏≠‡∏á Apps Script ‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á
                if (APPS_SCRIPT_URL === '‡πÉ‡∏™‡πà_URL_‡∏Ç‡∏≠‡∏á_Apps_Script_‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà') {
                    // ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö - ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô localStorage
                    loadingText.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...';
                    
                    // Simulate saving delay
                    await new Promise(resolve => setTimeout(resolve, 2000));
                    
                    // Save to localStorage for demo
                    const savedActivities = JSON.parse(localStorage.getItem('activities') || '[]');
                    const newActivity = {
                        id: Date.now(),
                        ...formData,
                        imageUrls: images.length > 0 ? 'demo-images' : '',
                        documentUrls: documents.length > 0 ? 'demo-documents' : ''
                    };
                    savedActivities.push(newActivity);
                    localStorage.setItem('activities', JSON.stringify(savedActivities));
                    
                    // Update global data
                    activitiesData = savedActivities;
                    
                    loadingModal.classList.add('hidden');
                    document.getElementById('successModal').classList.remove('hidden');
                    resetForm();
                    updateDashboard();
                    displayRecentActivities();
                    return;
                }
                
                loadingText.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå...';
                
                // Send to Apps Script
                const response = await fetch(APPS_SCRIPT_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        action: 'saveActivity',
                        activityName: formData.activityName,
                        activityDate: formData.activityDate,
                        responsible: formData.responsible,
                        targetGroup: formData.targetGroup,
                        objective: formData.objective,
                        details: formData.details,
                        results: formData.results,
                        timestamp: formData.timestamp,
                        images: images,
                        documents: documents,
                        imageCount: images.length,
                        documentCount: documents.length
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    loadingModal.classList.add('hidden');
                    document.getElementById('successModal').classList.remove('hidden');
                    resetForm();
                    loadActivities(); // Refresh data
                } else {
                    throw new Error(result.error || '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');
                }
                
            } catch (error) {
                loadingModal.classList.add('hidden');
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message);
                console.error('Error:', error);
            } finally {
                // Re-enable submit button
                submitBtn.disabled = false;
                submitBtn.innerHTML = '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
            }
        });

        // Load activities from Google Sheets or localStorage
        async function loadActivities() {
            // ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏™‡πà URL ‡πÉ‡∏´‡πâ‡πÇ‡∏´‡∏•‡∏î‡∏à‡∏≤‡∏Å localStorage ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö
            if (APPS_SCRIPT_URL === '‡πÉ‡∏™‡πà_URL_‡∏Ç‡∏≠‡∏á_Apps_Script_‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà') {
                activitiesData = JSON.parse(localStorage.getItem('activities') || '[]');
                updateDashboard();
                displayRecentActivities();
                return;
            }
            
            try {
                const response = await fetch(APPS_SCRIPT_URL + '?action=getActivities');
                const result = await response.json();
                
                if (result.success) {
                    activitiesData = result.data || [];
                    updateDashboard();
                    displayRecentActivities();
                }
            } catch (error) {
                console.error('Error loading activities:', error);
                // Fallback to localStorage if server fails
                activitiesData = JSON.parse(localStorage.getItem('activities') || '[]');
                updateDashboard();
                displayRecentActivities();
            }
        }

        // Update dashboard statistics
        function updateDashboard() {
            const total = activitiesData.length;
            const currentMonth = new Date().getMonth() + 1;
            const thisMonth = activitiesData.filter(activity => {
                const activityMonth = new Date(activity.activityDate).getMonth() + 1;
                return activityMonth === currentMonth;
            }).length;
            
            let totalImages = 0;
            activitiesData.forEach(activity => {
                if (activity.imageUrls) {
                    totalImages += activity.imageUrls.split(',').filter(url => url.trim()).length;
                }
            });
            
            document.getElementById('totalActivities').textContent = total;
            document.getElementById('totalImages').textContent = totalImages;
            document.getElementById('thisMonthActivities').textContent = thisMonth;
        }

        // Display recent activities
        function displayRecentActivities() {
            const container = document.getElementById('recentActivities');
            
            if (activitiesData.length === 0) {
                container.innerHTML = `
                    <div class="text-center text-gray-500 py-8">
                        <span class="text-4xl">üìù</span>
                        <p class="mt-2">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</p>
                        <button onclick="showTab('addActivity')" class="mt-4 bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                            ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡πÅ‡∏£‡∏Å
                        </button>
                    </div>
                `;
                return;
            }
            
            // Sort by date (newest first) and take first 5
            const recentActivities = activitiesData
                .sort((a, b) => new Date(b.activityDate) - new Date(a.activityDate))
                .slice(0, 5);
            
            container.innerHTML = recentActivities.map(activity => `
                <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <h3 class="font-semibold text-gray-900">${activity.activityName}</h3>
                            <p class="text-sm text-gray-600 mt-1">‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö: ${activity.responsible}</p>
                            <p class="text-sm text-gray-600">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î: ${new Date(activity.activityDate).toLocaleDateString('th-TH')}</p>
                            <p class="text-sm text-gray-500 mt-2">${activity.objective.substring(0, 100)}${activity.objective.length > 100 ? '...' : ''}</p>
                        </div>
                        <div class="text-right">
                            <span class="text-xs text-gray-400">
                                ${new Date(activity.timestamp).toLocaleDateString('th-TH')}
                            </span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Search functionality
        function searchActivities() {
            const searchName = document.getElementById('searchName').value.toLowerCase();
            const searchResponsible = document.getElementById('searchResponsible').value.toLowerCase();
            const searchMonth = document.getElementById('searchMonth').value;
            
            let filteredActivities = activitiesData.filter(activity => {
                const matchName = !searchName || activity.activityName.toLowerCase().includes(searchName);
                const matchResponsible = !searchResponsible || activity.responsible.toLowerCase().includes(searchResponsible);
                const matchMonth = !searchMonth || new Date(activity.activityDate).getMonth() + 1 === parseInt(searchMonth);
                
                return matchName && matchResponsible && matchMonth;
            });
            
            // Sort by date (newest first)
            filteredActivities.sort((a, b) => new Date(b.activityDate) - new Date(a.activityDate));
            
            displaySearchResults(filteredActivities);
        }

        function displaySearchResults(activities) {
            const container = document.getElementById('searchResults');
            
            if (activities.length === 0) {
                container.innerHTML = `
                    <div class="text-center text-gray-500 py-8">
                        <span class="text-4xl">üòî</span>
                        <p class="mt-2">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = `
                <div class="mb-4 text-sm text-gray-600">
                    ‡∏û‡∏ö ${activities.length} ‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°
                </div>
                ${activities.map(activity => `
                    <div class="border border-gray-200 rounded-lg p-6 mb-4 hover:shadow-md transition-shadow">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <h3 class="text-lg font-semibold text-gray-900 mb-2">${activity.activityName}</h3>
                                <div class="space-y-1 text-sm text-gray-600">
                                    <p><strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î:</strong> ${new Date(activity.activityDate).toLocaleDateString('th-TH')}</p>
                                    <p><strong>‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö:</strong> ${activity.responsible}</p>
                                    <p><strong>‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢:</strong> ${activity.targetGroup}</p>
                                </div>
                            </div>
                            <div>
                                <p class="text-sm text-gray-700"><strong>‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå:</strong></p>
                                <p class="text-sm text-gray-600 mt-1">${activity.objective}</p>
                                ${activity.imageUrls ? `
                                    <div class="mt-2">
                                        <span class="text-xs text-green-600">üì∏ ‡∏°‡∏µ‡∏†‡∏≤‡∏û‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°</span>
                                    </div>
                                ` : ''}
                            </div>
                        </div>
                        <div class="mt-4 pt-4 border-t border-gray-200">
                            <p class="text-sm text-gray-700"><strong>‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå:</strong></p>
                            <p class="text-sm text-gray-600 mt-1">${activity.results}</p>
                        </div>
                    </div>
                `).join('')}
            `;
        }

        function clearSearch() {
            document.getElementById('searchName').value = '';
            document.getElementById('searchResponsible').value = '';
            document.getElementById('searchMonth').value = '';
            
            document.getElementById('searchResults').innerHTML = `
                <div class="text-center text-gray-500 py-8">
                    <span class="text-4xl">üîç</span>
                    <p class="mt-2">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</p>
                </div>
            `;
        }

        // Reset form
        function resetForm() {
            document.getElementById('activityForm').reset();
            document.getElementById('filePreview').classList.add('hidden');
        }

        // Close success modal
        function closeSuccessModal() {
            document.getElementById('successModal').classList.add('hidden');
            showTab('dashboard');
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'979c4a5ee55fa18a',t:'MTc1Njk3NjM2My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
